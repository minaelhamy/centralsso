/*! reef v12.0.0 | (c) 2022 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
"use strict";function e(e,t,n=document){let r=new CustomEvent("reef:"+e,{bubbles:!0,cancelable:!0,detail:t});return n.dispatchEvent(r)}function t(e){return"string"==typeof e?document.querySelector(e):e}Object.defineProperty(exports,"__esModule",{value:!0});let n=["input","option","textarea"],r=["value","checked","selected"],o=["checked","selected"];function i(e){return["false","null","undefined","0","-0","NaN","0n","-0n"].includes(e)}function s(e,t,n){let r=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!r.includes("javascript:")&&!r.includes("data:text/html"))||(!(n||!e.startsWith("on"))||void 0)}function l(e,t,n,o){s(t,n,o)||(r.includes(t)&&(e[t]="value"===t?n:" "),e.setAttribute(t,n))}function c(e,t){r.includes(t)&&(e[t]=""),e.removeAttribute(t)}function d(e,t){if(1===e.nodeType){for(let{name:n,value:r}of e.attributes){if(s(n,r,t)){c(e,n);continue}if(!n.startsWith("@")&&!n.startsWith("#"))continue;let d=n.slice(1);c(e,n),o.includes(d)&&i(r)||l(e,d,r,t)}if(e.childNodes)for(let n of e.childNodes)d(n,t)}}function u(e){return e.childNodes&&e.childNodes.length?null:e.textContent}function a(e,t){return e.nodeType!==t.nodeType||e.tagName!==t.tagName||e.id!==t.id||e.src!==t.src}function f(e,t,s){let h=e.childNodes,m=t.childNodes;(function(e){let t=e.querySelectorAll("script");for(let e of t)e.remove()})(e)||(h.forEach((function(e,h){if(!m[h]){let n=e.cloneNode(!0);return d(n,s),void t.append(n)}if(a(e,m[h])){let t=function(e,t,n){return Array.from(t).slice(n+1).find((function(t){return!a(e,t)}))}(e,m,h);if(!t){let t=e.cloneNode(!0);return d(t,s),void m[h].before(t)}m[h].before(t)}if(function(e,t,s){if(1!==e.nodeType)return;let d=e.attributes,u=t.attributes;for(let{name:u,value:a}of d){if(u.startsWith("#"))continue;if(r.includes(u)&&n.includes(e.tagName.toLowerCase()))continue;let d=u.startsWith("@")?u.slice(1):u;o.includes(d)&&i(a)?c(t,d):l(t,d,a,s)}for(let{name:e,value:o}of u)d[e]||r.includes(e)&&n.includes(t.tagName.toLowerCase())||c(t,e)}(e,m[h],s),e.nodeName.includes("-"))return;let p=u(e);if(p&&p!==u(m[h])&&(m[h].textContent=p),e.childNodes.length||!m[h].childNodes.length){if(!m[h].childNodes.length&&e.childNodes.length){let t=document.createDocumentFragment();return f(e,t,s),void m[h].appendChild(t)}e.childNodes.length&&f(e,m[h],s)}else m[h].innerHTML=""})),function(e,t){let n=e.length-t.length;if(!(n<1))for(;n>0;n--)e[e.length-1].remove()}(m,h))}function h(n,r,o){let i=t(n);f(function(e){let t=(new DOMParser).parseFromString(e,"text/html");return t.head&&t.head.childNodes.length&&Array.from(t.head.childNodes).reverse().forEach((function(e){t.body.insertBefore(e,t.body.firstChild)})),t.body||document.createElement("body")}(r),i,o),e("render",null,i)}class m{constructor(e,t,n){var r;this.elem=e,this.template=t,this.stores=n.stores?n.stores.map(e=>"reef:store-"+e):["reef:store"],this.events=n.events,this.handler=(r=this,function(e){r.render()}),this.debounce=null,this.start()}start(){for(let e of this.stores)document.addEventListener(e,this.handler);this.render(),e("start",null,t(this.elem))}stop(){for(let e of this.stores)document.removeEventListener(e,this.handler);e("stop",null,t(this.elem))}render(){let e=this;e.debounce&&window.cancelAnimationFrame(e.debounce),e.debounce=window.requestAnimationFrame((function(){h(e.elem,e.template(),e.events)}))}}exports.component=function(e,t,n={}){return new m(e,t,n)},exports.render=h,exports.store=function(t={},n=""){return new Proxy(t,function t(n,r){let o="store"+(n?"-"+n:"");return{get:(e,o)=>"_isProxy"===o||(["object","array"].includes(Object.prototype.toString.call(e[o]).slice(8,-1).toLowerCase())&&!e[o]._isProxy&&(e[o]=new Proxy(e[o],t(n,r))),e[o]),set:(t,n,i)=>(t[n]===i||(t[n]=i,e(o,r)),!0),deleteProperty:(t,n)=>(delete t[n],e(o,r),!0)}}(n,t))};
